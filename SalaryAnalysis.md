108-2 大數據分析方法 作業一
================
put your name here

搞不清楚各行各業的薪資差異嗎? 念研究所到底對第一份工作的薪資影響有多大? CP值高嗎? 透過分析**初任人員平均經常性薪資**-
（107年）<https://data.gov.tw/dataset/6647>
（104-105年）<http://ipgod.nchc.org.tw/dataset/a17000000j-020066>
，可初步了解台灣近幾年各行各業、各學歷的起薪。

## 比較104年度和107年度大學畢業者的薪資資料

### 資料匯入與處理

``` r
library(readr)
library(rvest)
```

    ## Loading required package: xml2

    ## 
    ## Attaching package: 'rvest'

    ## The following object is masked from 'package:readr':
    ## 
    ##     guess_encoding

``` r
library(dplyr)
```

    ## 
    ## Attaching package: 'dplyr'

    ## The following objects are masked from 'package:stats':
    ## 
    ##     filter, lag

    ## The following objects are masked from 'package:base':
    ## 
    ##     intersect, setdiff, setequal, union

``` r
library(funModeling)
```

    ## Loading required package: Hmisc

    ## Loading required package: lattice

    ## Loading required package: survival

    ## Loading required package: Formula

    ## Loading required package: ggplot2

    ## 
    ## Attaching package: 'Hmisc'

    ## The following objects are masked from 'package:dplyr':
    ## 
    ##     src, summarize

    ## The following object is masked from 'package:rvest':
    ## 
    ##     html

    ## The following objects are masked from 'package:base':
    ## 
    ##     format.pval, units

    ## funModeling v.1.9.3 :)
    ## Examples and tutorials at livebook.datascienceheroes.com
    ##  / Now in Spanish: librovivodecienciadedatos.ai

``` r
library(data.table)
```

    ## 
    ## Attaching package: 'data.table'

    ## The following objects are masked from 'package:dplyr':
    ## 
    ##     between, first, last

``` r
library(dplyr)
library(rmarkdown)
library(knitr)
Occ107 <- read_csv("C:/Users/User/Desktop/HW/Occ107.csv")
```

    ## Parsed with column specification:
    ## cols(
    ##   年度 = col_double(),
    ##   大職業別 = col_character(),
    ##   `經常性薪資-薪資` = col_character(),
    ##   `經常性薪資-女/男` = col_character(),
    ##   `國中及以下-薪資` = col_character(),
    ##   `國中及以下-女/男` = col_character(),
    ##   `高中或高職-薪資` = col_character(),
    ##   `高中或高職-女/男` = col_character(),
    ##   `專科-薪資` = col_character(),
    ##   `專科-女/男` = col_character(),
    ##   `大學-薪資` = col_character(),
    ##   `大學-女/男` = col_character(),
    ##   `研究所-薪資` = col_character(),
    ##   `研究所-女/男` = col_character()
    ## )

``` r
Occ104 <- read_csv("C:/Users/User/Desktop/HW/Occ104.csv")
```

    ## Parsed with column specification:
    ## cols(
    ##   年度 = col_double(),
    ##   大職業別 = col_character(),
    ##   `經常性薪資-薪資` = col_double(),
    ##   `經常性薪資-女/男` = col_character(),
    ##   `國中及以下-薪資` = col_character(),
    ##   `國中及以下-女/男` = col_character(),
    ##   `高中或高職-薪資` = col_character(),
    ##   `高中或高職-女/男` = col_character(),
    ##   `專科-薪資` = col_character(),
    ##   `專科-女/男` = col_character(),
    ##   `大學-薪資` = col_character(),
    ##   `大學-女/男` = col_character(),
    ##   `研究所及以上-薪資` = col_character(),
    ##   `研究所及以上-女/男` = col_character()
    ## )

``` r
for(n in 1:14)
{Occ104[[n]] <- gsub("—|…",NA,Occ104[[n]])
Occ107[[n]] <- gsub("—|…",NA,Occ107[[n]])}

for(n in 3:14)
{Occ104[[n]] <- as.numeric(Occ104[[n]])
Occ107[[n]] <- as.numeric(Occ107[[n]])}
#將奇怪的字符取代成空字串並將所有欄位轉成數字型態
Occ104[[2]] <- gsub("部門","",Occ104[[2]])
Occ107[[2]] <- gsub("_","、",Occ104[[2]])
Occ107[[2]] <- gsub("工程","業",Occ104[[2]])
Occ107[[2]] <- gsub("出版、影音製作、傳播及資通訊服務業","資訊及通訊傳播業",Occ104[[2]])
Occ107[[2]] <- gsub("教育業","教育服務業",Occ104[[2]])
Occ107[[2]] <- gsub("醫療保健業","醫療保健服務業",Occ104[[2]])
#統一104和107年的職業名稱
Occ_Compare <-
  inner_join(Occ104,Occ107,by=c("大職業別"))
#根據職業名稱合併表格 x=104 y=107
```

### 107年度薪資較104年度薪資高的職業有哪些?

``` r
Occ_Q1 <-select(Occ_Compare,大職業別,`大學-薪資.x`,`大學-薪資.y`)
Occ_Q1$薪資比較 <- as.numeric(Occ_Q1$`大學-薪資.y`) / as.numeric(Occ_Q1$`大學-薪資.x`)
Occ_Q1<-arrange(Occ_Q1,desc(薪資比較))
filter(Occ_Q1,Occ_Q1$薪資比較>=1)
```

    ## # A tibble: 105 x 4
    ##    大職業別                                 `大學-薪資.x` `大學-薪資.y` 薪資比較
    ##    <chr>                                            <dbl>         <dbl>    <dbl>
    ##  1 專業、科學及技術服務業-服務及銷售工作人員~         24423         28304     1.16
    ##  2 教育服務業-服務及銷售工作人員                    24324         27543     1.13
    ##  3 不動產業-技術員及助理專業人員                    27338         30914     1.13
    ##  4 住宿及餐飲業-服務及銷售工作人員                  23548         26111     1.11
    ##  5 藝術、娛樂及休閒服務業-事務支援人員              24244         26611     1.10
    ##  6 金融及保險業-技藝、機械設備操作及組裝人員~         30074         32997     1.10
    ##  7 教育服務業                                       25162         27582     1.10
    ##  8 教育服務業-事務支援人員                          23643         25908     1.10
    ##  9 用水供應及污染整治業-專業人員                    32179         34957     1.09
    ## 10 教育服務業-專業人員                              26615         28911     1.09
    ## # ... with 95 more rows

``` r
head(Occ_Q1[order(Occ_Q1$薪資比較,decreasing = T),],10)
```

    ## # A tibble: 10 x 4
    ##    大職業別                                 `大學-薪資.x` `大學-薪資.y` 薪資比較
    ##    <chr>                                            <dbl>         <dbl>    <dbl>
    ##  1 專業、科學及技術服務業-服務及銷售工作人員~         24423         28304     1.16
    ##  2 教育服務業-服務及銷售工作人員                    24324         27543     1.13
    ##  3 不動產業-技術員及助理專業人員                    27338         30914     1.13
    ##  4 住宿及餐飲業-服務及銷售工作人員                  23548         26111     1.11
    ##  5 藝術、娛樂及休閒服務業-事務支援人員              24244         26611     1.10
    ##  6 金融及保險業-技藝、機械設備操作及組裝人員~         30074         32997     1.10
    ##  7 教育服務業                                       25162         27582     1.10
    ##  8 教育服務業-事務支援人員                          23643         25908     1.10
    ##  9 用水供應及污染整治業-專業人員                    32179         34957     1.09
    ## 10 教育服務業-專業人員                              26615         28911     1.09

可以發現服務業佔大多數，前10名中就有7個服務業

### 提高超過5%的的職業有哪些?

``` r
filter(Occ_Q1,Occ_Q1$薪資比較>1.05)
```

    ## # A tibble: 53 x 4
    ##    大職業別                                 `大學-薪資.x` `大學-薪資.y` 薪資比較
    ##    <chr>                                            <dbl>         <dbl>    <dbl>
    ##  1 專業、科學及技術服務業-服務及銷售工作人員~         24423         28304     1.16
    ##  2 教育服務業-服務及銷售工作人員                    24324         27543     1.13
    ##  3 不動產業-技術員及助理專業人員                    27338         30914     1.13
    ##  4 住宿及餐飲業-服務及銷售工作人員                  23548         26111     1.11
    ##  5 藝術、娛樂及休閒服務業-事務支援人員              24244         26611     1.10
    ##  6 金融及保險業-技藝、機械設備操作及組裝人員~         30074         32997     1.10
    ##  7 教育服務業                                       25162         27582     1.10
    ##  8 教育服務業-事務支援人員                          23643         25908     1.10
    ##  9 用水供應及污染整治業-專業人員                    32179         34957     1.09
    ## 10 教育服務業-專業人員                              26615         28911     1.09
    ## # ... with 43 more rows

### 主要的職業種別是哪些種類呢?

``` r
Occ_Q1_Count <- filter(Occ_Q1,Occ_Q1$薪資比較>1.05)
Occ_Q1_test1 <- strsplit(Occ_Q1_Count$大職業別,"-")
Occ_Q1_test2 <- lapply(Occ_Q1_test1, "[",1)
knitr::kable(table(unlist(Occ_Q1_test2)))
```

| Var1        | Freq |
| :---------- | ---: |
| 工業          |    3 |
| 工業及服務業      |    1 |
| 不動產業        |    5 |
| 支援服務業       |    1 |
| 用水供應及污染整治業  |    3 |
| 住宿及餐飲業      |    4 |
| 批發及零售業      |    1 |
| 其他服務業       |    1 |
| 服務業         |    1 |
| 金融及保險業      |    5 |
| 專業、科學及技術服務業 |    1 |
| 教育服務業       |    4 |
| 資訊及通訊傳播業    |    5 |
| 運輸及倉儲業      |    5 |
| 電力及燃氣供應業    |    1 |
| 製造業         |    2 |
| 營造業         |    4 |
| 醫療保健服務業     |    1 |
| 藝術、娛樂及休閒服務業 |    5 |

## 男女同工不同酬現況分析

男女同工不同酬一直是性別平等中很重要的問題，分析資料來源為103到106年度的大學畢業薪資。

### 104和107年度的大學畢業薪資資料，哪些行業男生薪資比女生薪資多?

``` r
Occ_Q2<-select(Occ_Compare,大職業別,`大學-女/男.x`,`大學-女/男.y`)

#104年 男生薪資比女生薪資多的職業的前10
arrange(Occ_Q2,`大學-女/男.x`)
```

    ## # A tibble: 140 x 3
    ##    大職業別                                        `大學-女/男.x` `大學-女/男.y`
    ##    <chr>                                                    <dbl>          <dbl>
    ##  1 電力及燃氣供應業-技藝、機械設備操作及組裝人員             91.7          100. 
    ##  2 教育服務業-服務及銷售工作人員                             91.9          100  
    ##  3 礦業及土石採取業-技術員及助理專業人員                     92.4           98.5
    ##  4 礦業及土石採取業-技藝、機械設備操作及組裝人員             93.1          100  
    ##  5 礦業及土石採取業                                          95.3           97.1
    ##  6 其他服務業-事務支援人員                                   95.5           99.3
    ##  7 營造業-技藝、機械設備操作及組裝人員                       95.6           99.6
    ##  8 用水供應及污染整治業-技藝、機械設備操作及組裝人員~           95.9           99.3
    ##  9 營造業                                                    96.4           97.5
    ## 10 教育服務業                                                96.4           98.6
    ## # ... with 130 more rows

``` r
#107年 男生薪資比女生薪資多的職業的前10名
arrange(Occ_Q2,`大學-女/男.y`)
```

    ## # A tibble: 140 x 3
    ##    大職業別                                `大學-女/男.x` `大學-女/男.y`
    ##    <chr>                                            <dbl>          <dbl>
    ##  1 礦業及土石採取業-專業人員                         97.0           96.0
    ##  2 電力及燃氣供應業-事務支援人員                     96.6           97.0
    ##  3 礦業及土石採取業                                  95.3           97.1
    ##  4 營造業                                            96.4           97.5
    ##  5 教育服務業-事務支援人員                           98.5           97.6
    ##  6 電力及燃氣供應業-服務及銷售工作人員               NA             97.7
    ##  7 營造業-技術員及助理專業人員                       97.0           97.8
    ##  8 用水供應及污染整治業-專業人員                     98.1           97.8
    ##  9 用水供應及污染整治業-服務及銷售工作人員          100             97.9
    ## 10 電力及燃氣供應業-專業人員                         98.3           98.2
    ## # ... with 130 more rows

### 哪些行業女生薪資比男生薪資多?

``` r
#104年 女生薪資比男生薪資多的職業的前10名
arrange(Occ_Q2,desc(`大學-女/男.x`))
```

    ## # A tibble: 140 x 3
    ##    大職業別                                        `大學-女/男.x` `大學-女/男.y`
    ##    <chr>                                                    <dbl>          <dbl>
    ##  1 專業、科學及技術服務業-技藝、機械設備操作及組裝人員~          100.            99.1
    ##  2 用水供應及污染整治業-服務及銷售工作人員                  100             97.9
    ##  3 不動產業-技藝、機械設備操作及組裝人員                    100            100  
    ##  4 醫療保健服務業-服務及銷售工作人員                        100             99.8
    ##  5 其他服務業-專業人員                                      100             98.3
    ##  6 住宿及餐飲業-技術員及助理專業人員                         99.9           99.7
    ##  7 支援服務業-技術員及助理專業人員                           99.9           98.4
    ##  8 住宿及餐飲業-服務及銷售工作人員                           99.9           99.8
    ##  9 用水供應及污染整治業-技術員及助理專業人員                 99.8           99.7
    ## 10 運輸及倉儲業-技藝、機械設備操作及組裝人員                 99.8           99.8
    ## # ... with 130 more rows

``` r
#107年 女生薪資比男生薪資多的職業的前10名
arrange(Occ_Q2,desc(`大學-女/男.y`))
```

    ## # A tibble: 140 x 3
    ##    大職業別                                      `大學-女/男.x` `大學-女/男.y`
    ##    <chr>                                                  <dbl>          <dbl>
    ##  1 礦業及土石採取業-技藝、機械設備操作及組裝人員           93.1           100 
    ##  2 資訊及通訊傳播業-技藝、機械設備操作及組裝人員           96.8           100 
    ##  3 金融及保險業-服務及銷售工作人員                         98.9           100 
    ##  4 金融及保險業-技藝、機械設備操作及組裝人員               98.3           100 
    ##  5 不動產業-服務及銷售工作人員                             99.7           100 
    ##  6 不動產業-技藝、機械設備操作及組裝人員                  100             100 
    ##  7 專業、科學及技術服務業-服務及銷售工作人員               99.3           100 
    ##  8 教育服務業-服務及銷售工作人員                           91.9           100 
    ##  9 電力及燃氣供應業-技藝、機械設備操作及組裝人員           91.7           100.
    ## 10 金融及保險業-專業人員                                   99.3           100.
    ## # ... with 130 more rows

可以發現男生薪資比女生薪資高的職業，苦力類型的較多一些，諸如技藝、機械設備操作及組裝人員等，而比較104年和107年的差異，可以看出組裝人員的需求下降，專業人員的需求上升，且水電方面的需求增多，顯然組裝這類工作漸漸被機器取代，而隨著人口增長、建案不斷落成，水電需求也越來越高。

而女生薪資比男生薪資高的部分則剛好與男生相反，專業人員的需求下降，組裝人員則提升，意味著女生的細心或許在組裝方面更受企業青睞，金融、不動產等需要接待客人的工作也是女生較為吃香。

## 研究所薪資差異

以107年度的資料來看，哪個職業別念研究所最划算呢 (研究所學歷薪資與大學學歷薪資增加比例最多)?

``` r
Occ_Q3<-select(Occ_Compare,大職業別,`大學-薪資.y`,`研究所-薪資`)
Occ_Q3$學歷薪資比較 <-
as.numeric(Occ_Q3$`研究所-薪資`) / as.numeric(Occ_Q3$`大學-薪資.y`)
Occ_Q3 <- arrange(Occ_Q3,desc(學歷薪資比較))
head(Occ_Q3[order(Occ_Q3$學歷薪資比較,decreasing = T),],10)
```

    ## # A tibble: 10 x 4
    ##    大職業別                        `大學-薪資.y` `研究所-薪資` 學歷薪資比較
    ##    <chr>                                   <dbl>         <dbl>        <dbl>
    ##  1 其他服務業                              25781         31909         1.24
    ##  2 專業、科學及技術服務業                  29353         35381         1.21
    ##  3 專業、科學及技術服務業-專業人員         32460         39103         1.20
    ##  4 教育服務業-事務支援人員                 25908         30827         1.19
    ##  5 資訊及通訊傳播業                        29143         34503         1.18
    ##  6 其他服務業-事務支援人員                 26115         30830         1.18
    ##  7 資訊及通訊傳播業-專業人員               31763         37479         1.18
    ##  8 製造業                                  28777         33916         1.18
    ##  9 工業                                    28850         33893         1.17
    ## 10 工業及服務業                            28849         33880         1.17

首先能看出薪資差異最多的是其他服務業。

可以看的出來前十名都是對專業度要求較高的職業，意味著企業普遍認為研究所的專業度高於大學畢業，於是連帶影響兩者的薪資高低。

## 我有興趣的職業別薪資狀況分析

### 有興趣的職業別篩選，呈現薪資

``` r
Occ_Q4<-select(Occ_Compare,大職業別,`大學-薪資.y`,`研究所-薪資`)
Occ_Q4$薪資差別<-as.numeric(Occ_Q4$`研究所-薪資`) - as.numeric(Occ_Q4$`大學-薪資.y`)
Occ_Q4_S1<-subset(Occ_Q4,大職業別=="資訊及通訊傳播業")
Occ_Q4_S2<-subset(Occ_Q4,大職業別=="醫療保健服務業")
Occ_Q4_S3<-subset(Occ_Q4,大職業別=="金融及保險業")
Occ_Q4_S4<-subset(Occ_Q4,大職業別=="住宿及餐飲業")
Occ_Q4_S5<-subset(Occ_Q4,大職業別=="教育服務業")
```

### 這些職業別研究所薪資與大學薪資差多少呢？

``` r
head(Occ_Q4_S1)
```

    ## # A tibble: 1 x 4
    ##   大職業別         `大學-薪資.y` `研究所-薪資` 薪資差別
    ##   <chr>                    <dbl>         <dbl>    <dbl>
    ## 1 資訊及通訊傳播業         29143         34503     5360

``` r
head(Occ_Q4_S2)
```

    ## # A tibble: 1 x 4
    ##   大職業別       `大學-薪資.y` `研究所-薪資` 薪資差別
    ##   <chr>                  <dbl>         <dbl>    <dbl>
    ## 1 醫療保健服務業         29590         34436     4846

``` r
head(Occ_Q4_S3)
```

    ## # A tibble: 1 x 4
    ##   大職業別     `大學-薪資.y` `研究所-薪資` 薪資差別
    ##   <chr>                <dbl>         <dbl>    <dbl>
    ## 1 金融及保險業         32448         37228     4780

``` r
head(Occ_Q4_S4)
```

    ## # A tibble: 1 x 4
    ##   大職業別     `大學-薪資.y` `研究所-薪資` 薪資差別
    ##   <chr>                <dbl>         <dbl>    <dbl>
    ## 1 住宿及餐飲業         27213         30079     2866

``` r
head(Occ_Q4_S5)
```

    ## # A tibble: 1 x 4
    ##   大職業別   `大學-薪資.y` `研究所-薪資` 薪資差別
    ##   <chr>              <dbl>         <dbl>    <dbl>
    ## 1 教育服務業         27582         30509     2927

資訊及通訊傳播業，薪資較想像中低，研究所薪資與大學薪資相差5360元，我會因此決定念研究所。

醫療保健服務業，薪資較想像中低，研究所薪資與大學薪資相差4846元，我會因此決定念研究所。

金融及保險業，薪資較想像中高，研究所薪資與大學薪資相差4780元，我會因此決定念研究所。

住宿及餐飲業，薪資較想像中低，研究所薪資與大學薪資相差2866元，我會因此決定不念研究所。

教育服務業，薪資較想像中低，研究所薪資與大學薪資相差2927元，我會因此決定不念研究所。
